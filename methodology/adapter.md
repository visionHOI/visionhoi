### 语义适配器（Semantic Adapter）
#### 模块定位
语义适配器是为LAIN模型文本特征分支新增的轻量化增强模块，仅作用于CLIP文本编码器输出的**原始文本嵌入**（不改动CLIP编码过程、不介入视觉侧处理），核心解决通用文本特征在HOI检测场景中语义区分度不足的问题，且支持通过开关灵活启用/关闭，适配有限显存的训练环境。

#### 核心工作流程
1. **文本编码**：HOI/物体类别文本先经CLIP文本编码器生成固定维度的原始文本嵌入，保留CLIP预训练的通用语义；
2. **语义增强**：启用适配器后，原始文本嵌入送入适配器，通过低维度线性变换学习HOI场景专属语义，生成增强文本嵌入；
3. **特征匹配**：增强后的文本嵌入与视觉侧HO token计算相似度，完成HOI预测。

#### 关键设计
##### （1）轻量化设计
适配器采用低秩线性结构，通过`adapt_dim`（默认64维）控制核心维度（远低于CLIP文本嵌入的512/768维），新增参数量≤CLIP文本编码器的5%，不增加推理耗时。

##### （2）残差融合
适配器保留原始文本嵌入作为残差分支，增强特征与原始特征融合，既补充HOI专属语义，又不破坏CLIP预训练的核心语义，避免特征失真。

##### （3）基础结构与参数初始化
适配器的核心初始化逻辑如下： 
输入 / 输出维度固定为 768 维（匹配 CLIP 文本嵌入维度），瓶颈维度（bottleneck）由参数adapt_dim控制（默认 64 维）；
新增 LayerNorm 层保证训练稳定性，降维（down）和升维（up）层均采用无偏置线性层，且升维层权重初始化为全 0，确保适配器初始状态为 “恒等映射”（不破坏原始文本特征）；
激活函数选用 GELU（适配 Transformer 类模型的特征分布，优于 ReLU）。

##### （4）前向传播逻辑
适配器的前向流程严格遵循 “残差融合” 原则，步骤为：
保留原始文本嵌入作为残差分支（residual = x）；
对输入文本嵌入做层归一化（self.norm(x)），消除特征尺度差异；1
归一化特征经降维层压缩至 64 维瓶颈空间，通过 GELU 激活后，再经升维层恢复至 768 维；
增强特征与残差分支逐元素相加，输出最终文本嵌入（既保留 CLIP 预训练语义，又注入 HOI 场景专属语义）。
